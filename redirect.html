<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Authorization Code</title>
    <style>
        /* Nội dung styles.css */
        body {
            background: #ffe4c4;
        }

        pre {
            position: relative;
            background: #d3d6db;
            padding: 10px;
            font-size: 15px;
            word-wrap: break-word;
            white-space: pre-wrap;
            border: 1px solid #e6e7e9;
            max-width: 500px;
        }

        .copy-button {
            position: absolute;
            top: 2px;
            right: 10px;
            cursor: pointer;
            color: #fff;
            background: gray;
            border-radius: 0.5em;
            padding: 2px 7px;
        }

        .copy-button:hover {
            color: #000;
        }
    </style>
</head>
<body>
    <h2>Your Authorization Code:</h2>
    
    <!-- Hiển thị mã ủy quyền trong thẻ <pre> -->
    <pre id="myPreTag">Loading...</pre>

    <script>
        // Nội dung script.js
        // Lấy mã từ URL
        const params = new URLSearchParams(window.location.search);
        const code = params.get('code');

        // Hiển thị mã hoặc thông báo lỗi trong <pre> tag
        const preTag = document.getElementById("myPreTag");
        if (code) {
            preTag.innerText = code;
        } else {
            preTag.innerText = "Authorization code not found in the URL.";
        }

        // Tạo nút sao chép
        const copyButton = document.createElement("span");
        copyButton.innerText = "Copy";
        copyButton.classList.add("copy-button");

        // Thêm nút sao chép vào <pre> tag
        preTag.appendChild(copyButton);

        // Thêm sự kiện khi nhấn nút sao chép
        copyButton.addEventListener("click", () => {
            // Tạm thời ẩn nút sao chép
            copyButton.style.display = "none";

            // Tạo một range và chọn text trong <pre> tag
            const range = document.createRange();
            range.selectNode(preTag);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);

            try {
                // Sao chép văn bản đã chọn vào clipboard
                document.execCommand("copy");

                // Thông báo rằng đã sao chép thành công
                copyButton.innerText = "Copied!";
                setTimeout(function(){
                    copyButton.innerText = "Copy";
                }, 2000);
            } catch (err) {
                console.error("Unable to copy text:", err);
            } finally {
                // Hiển thị lại nút sao chép
                copyButton.style.display = "inline";

                // Bỏ chọn text
                window.getSelection().removeAllRanges();
            }
        });
    </script>
</body>
</html>
